const wc=window.gtmkit_settings.wc,datalayer_name=window.gtmkit_settings.datalayer_name;function gtmkit_load(){let i,o={"wp-block-handpicked-products":1,"wp-block-product-best-sellers":1,"wp-block-product-category":1,"wp-block-product-new":1,"wp-block-product-on-sale":1,"wp-block-products-by-attribute":1,"wp-block-product-tag":1,"wp-block-product-top-rated":1},t=(document.querySelectorAll(".wc-block-grid .wc-block-grid__product").forEach(function(t){var e=t.closest(".wc-block-grid");const r=t.querySelector(".gtmkit_product_data");if(e&&r){const c=e.classList;if(c)for(var a in o)if(c.contains(a)){let t=JSON.parse(r.getAttribute("data-gtmkit_product_data"));t.item_list_name=wc.text[a],t.index=o[a],r.setAttribute("data-gtmkit_product_data",JSON.stringify(t)),o[a]++}}}),document.querySelectorAll(".gtmkit_product_data"));if(t.length){let e=[],r;t.forEach(function(t){r=JSON.parse(t.getAttribute("data-gtmkit_product_data")),e.push(r)}),window[datalayer_name].push({event:"view_item_list",ecommerce:{items:e}})}document.addEventListener("click",function(t){let e=t.target;if(!e||!e.closest(".add_to_cart_button:not(.single_add_to_cart_button)"))return!0;const r=e.closest(".product,.wc-block-grid__product"),a=r&&r.querySelector(".gtmkit_product_data");if(!a)return!0;t=JSON.parse(a.getAttribute("data-gtmkit_product_data"));window[datalayer_name].push({event:"add_to_cart",ecommerce:{currency:wp.currency,value:t.price,items:[t]}})}),document.addEventListener("click",function(e){let t=e.target;if(!t||!t.closest(".single_add_to_cart_button:not(.disabled)"))return!0;const r=t.closest("form.cart");if(!r)return!0;var e=r.querySelectorAll("[name=variation_id]"),a=r.classList&&r.classList.contains("grouped_form");if(e.length)i&&(e=r.querySelector("[name=quantity]"),i.quantity=e&&e.value||1,window[datalayer_name].push({event:"add_to_cart",ecommerce:{currency:wp.currency,value:i.price*i.quantity,items:[i]}}));else if(a){const o=document.querySelectorAll(".grouped_form .gtmkit_product_data");let a=[],c=0;if(o.forEach(function(t){var e=document.querySelectorAll("input[name=quantity\\["+t.getAttribute("data-gtmkit_product_id")+"\\]]");if(console.log(t.getAttribute("data-gtmkit_product_id")),console.log(e),0==(e=parseInt(e[0].value)))return!0;let r=JSON.parse(t.getAttribute("data-gtmkit_product_data"));r.quantity=e,a.push(r),c+=r.price*r.quantity}),0==a.length)return!0;window[datalayer_name].push({event:"add_to_cart",ecommerce:{currency:wp.currency,value:c,items:a}})}else{let t=JSON.parse(r.querySelector("[name=gtmkit_product_data]")&&r.querySelector("[name=gtmkit_product_data]").value);e=r.querySelector("[name=quantity]")&&r.querySelector("[name=quantity]").value;t.quantity=e,window[datalayer_name].push({event:"add_to_cart",ecommerce:{currency:wp.currency,value:t.price*t.quantity,items:[t]}})}}),document.addEventListener("click",function(t){const e=t.target;return!e||!e.closest(".mini_cart_item a.remove,.product-remove a.remove")||(!(t=JSON.parse(e.getAttribute("data-gtmkit_product_data")))||void window[datalayer_name].push({event:"remove_from_cart",ecommerce:{items:[t]}}))});document.addEventListener("click",function(t){const e=t.target;if(!e.closest(".products li:not(.product-category) a:not(.add_to_cart_button),.wc-block-grid__products li:not(.product-category) a:not(.add_to_cart_button),.woocommerce-grouped-product-list-item__label a"))return!0;let r=e.closest(".product,.wc-block-grid__product"),a;return!r||(void 0===(a=r.querySelector(".gtmkit_product_data")).getAttribute("data-gtmkit_product_data")||(!(t=JSON.parse(a.getAttribute("data-gtmkit_product_data")))||void window[datalayer_name].push({event:"select_item",ecommerce:{items:[t]}})))}),jQuery(document).on("found_variation",function(r,a){if(void 0!==a){const o=r.target;let t=JSON.parse(o.querySelector("[name=gtmkit_product_data]")&&o.querySelector("[name=gtmkit_product_data]").value),e=(t.item_id=a.variation_id,wc.use_sku&&a.sku&&""!==a.sku&&(t.item_id=a.sku),t.price=a.display_price,[]);for(var c in a.attributes)e.push(a.attributes[c]);t.variant=e.join(","),i=t,window[datalayer_name].push({event:"view_item",ecommerce:{currency:wp.currency,value:t.price,items:[t]}})}}),wc.is_cart&&gtmkit_cart(),wc.is_checkout&&gtmkit_checkout()}"loading"==document.readyState?document.addEventListener("DOMContentLoaded",gtmkit_load):gtmkit_load();